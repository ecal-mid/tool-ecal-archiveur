{% extends "base.html" %}

{% block header %}

  <header>
    <img class="logo" src="/static/res/logo.svg">
    <div class="path"></div>
    <div class="avatar"><img src="{{user.img}}"></div>
  </header>

{% endblock %}


{% block main %}

  <section id="app" class="app">
    <main>

    </main>
  </section>
{% endblock %}


{% block scripts %}

<!-- templates -->
<script type="text/template" id="assignment-tpl">
  <h2><%= assignment.name %>, due for <%= due %></h2>
  <div class="assignment-entries">
  <% for(var i=0; i<assignment.entries.length; i++) { %>
  	<%- include('entry-tpl', {assignment:assignment, entry:assignment.entries[i], is_assignment:true }) -%>
  <% } %>
  <%- include('new-entry-tpl', {user:user}) -%>
  </div>
  <div class="groups">
    <% for(var i=0; i<groups.length; i++) { %>
      <div class="group <%= groups[i].classes.join(' ') %>" data-id="<%= i %>">
        <% for(var j=0; j<groups[i].users.length; j++) { %>
          <% var u = groups[i].users[j]; %>
          <div class="avatar"><img src="https://intranet.ecal.ch/img/photo/<%= u.photo %>"></div>
        <% } %>
        <p>Group <%= i %></p>
      </div>
    <% } %>
  </div>
  <div class="assigned-entries">
  <% for(var i=0; i<entries.length; i++) { %>
  	<%- include('entry-tpl', {assignment:assignment, entry:entries[i] }) -%>
  <% } %>
  <%- include('new-entry-tpl', {user:user}) -%>
  </div>
</script>

<script type="text/template" id="entry-tpl">
  <div class="entry-row">
    <div class="entry <%= classes.join(' ') %>">
      <div class="avatar">
        <img src="https://intranet.ecal.ch/img/photo/<%= user.photo %>">
      </div>
      <p class="entry-user"><%= user.name %><br><span class="entry-date"><%= date %></span></p>
      <% if (entry.text) { %>
        <p><%= entry.text %></p>
      <% } else { %>
        <a href="<%= entry.file %>" target="_blank"><%= filename %></a>
        <a href="<%= entry.file %>" target="_blank"><i class="md-icon">file_download</i></a>
      <% } %>
    </div>
  </div>
</script>

<script type="text/template" id="new-entry-tpl">
  <div class="entry-row">
    <div class="entry new-entry">
      <div class="avatar">
        <img src="<%= user.img %>">
      </div>
      <input class="new-entry-text" type="text" placeholder="Add comment" />
      <span class="entry__send-text"><i class="md-icon">send</i></span>
    </div>
    <form method="post" action="/api/upload" enctype="multipart/form-data" novalidate class="box">
      <div class="box__input">
        <i class="md-icon">file_upload</i>
        <input type="file" name="file" id="file" class="box__file" />
        <label for="file">Add File<span class="box__dragndrop"></span><br><span class="box__error"></span></label>
        <button type="submit" class="box__button">Add File</button>
      </div>
      <div class="box__uploading">Uploading&hellip;</div>
    </form>
  </div>
</script>

<!-- third parties -->
<script src="{{ url_for('static', filename='libs/qwest.min.js') }}"></script>
<script src="{{ url_for('static', filename='libs/ejs.min.js') }}"></script>
<!-- scripts -->
<script src="{{ url_for('static', filename='js/utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/upload_box.js') }}"></script>
<script src="{{ url_for('static', filename='js/assignment.js') }}"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}
